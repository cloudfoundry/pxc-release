#!/bin/bash

set -eu

: "${MYSQL_USERNAME:?Error: MYSQL_USERNAME environment variable is required}"
: "${MYSQL_PASSWORD:?Error: MYSQL_PASSWORD environment variable is required}"
: "${TIMEOUT:?Error: TIMEOUT environment variable is required}"

: "${MYSQL_USERNAME:=<%= p('connection_test_user') %>}"k


export MYSQL_USERNAME="<%= p('connection_test_user') %>"
export MYSQL_PASSWORD="<%= p('connection_test_password') %>"

# TODO: Rethink the necessity of these...
export TIMEOUT=5
export MYSQL_HOST=localhost

/var/vcap/packages/proxy/bin/db-ping
